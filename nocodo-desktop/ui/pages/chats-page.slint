import { VerticalBox, ComboBox } from "std-widgets.slint";
import { DesktopSizes, DesktopColors, DesktopTypography } from "../theme.slint";
import { StyledTextArea } from "../components/styled-textarea.slint";

export component ChatsPage inherits Rectangle {
    in-out property <[string]> agent-names;
    in-out property <string> input-text;
    in-out property <int> selected-agent-index: -1;

    callback start-agent-clicked();

    background: DesktopColors.background;
    horizontal-stretch: 1;

    VerticalLayout {
        alignment: center;

        chat_layout := HorizontalLayout {
            padding: DesktopSizes.space_lg;

            // Left spacer for centering
            Rectangle {
                horizontal-stretch: 1;
            }

            VerticalBox {
                spacing: DesktopSizes.space_md;
                min-width: DesktopSizes.textarea_min_width;
                max-width: DesktopSizes.textarea_max_width;
                horizontal-stretch: 1;

                // Textarea with 5 rows
                StyledTextArea {
                    text <=> root.input-text;
                    min-height: 5 * DesktopTypography.font_base * DesktopTypography.line_height_normal;
                    preferred-height: self.min-height;
                    horizontal-stretch: 1;
                }

                // Dropdown for agents
                Rectangle {
                    height: DesktopSizes.input_height;

                    ComboBox {
                        model: root.agent-names;
                        current-index <=> root.selected-agent-index;
                    }
                }

                // Start button
                Rectangle {
                    height: DesktopSizes.input_height;

                    HorizontalLayout {
                        alignment: end;

                        start-button := Rectangle {
                            width: 120px;
                            height: DesktopSizes.input_height;
                            background: touch-area.has-hover ? DesktopColors.primary_hover : DesktopColors.primary;
                            border-radius: DesktopSizes.radius_sm;

                            Text {
                                text: "Start";
                                color: Colors.white;
                                font-size: DesktopTypography.font_base;
                                font-weight: DesktopTypography.weight_medium;
                                horizontal-alignment: center;
                                vertical-alignment: center;
                            }

                            touch-area := TouchArea {
                                clicked => {
                                    root.start-agent-clicked();
                                }
                            }
                        }
                    }
                }
            }

            // Right spacer for centering
            Rectangle {
                horizontal-stretch: 1;
            }
        }
    }
}
